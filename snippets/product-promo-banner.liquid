{%- comment -%}
  Renders a product promotional banner from metaobject

  Usage:
  {% render 'product-promo-banner', product: product %}

  Expects metaobject: product.metafields.custom.promo_banner with fields:
  - title (string)
  - image (file)
  - background_color_start (color)
  - background_color_end (color)
  - badge_text (string, optional)
{%- endcomment -%}

{%- assign promo = product.metafields.custom.promo_banner.value -%}

<!-- DEBUG: promo_banner exists: {{ product.metafields.custom.promo_banner }} -->
<!-- DEBUG: promo_banner.value: {{ promo }} -->
<!-- DEBUG: promo.title: {{ promo.title }} -->

{% if promo %}
  <div class="product-promo-banner">
    <div class="product-promo-banner__content">
      <div class="product-promo-banner__text-container">
        {% if promo.title %}
          <h3 class="product-promo-banner__title">{{ promo.title }}</h3>
        {% endif %}
      </div>

      {% if promo.image %}
        <div class="product-promo-banner__image-container">
          {% if promo.badge_text %}
            <div class="product-promo-banner__badge">{{ promo.badge_text }}</div>
          {% endif %}
          {{ promo.image | image_url: width: 300 | image_tag: loading: 'lazy', class: 'product-promo-banner__image' }}
        </div>
      {% endif %}
    </div>
  </div>

  <style>
    .product-promo-banner {
      width: 100%;
      margin: calc(var(--gap, 8px) * 2) 0;
    }

    .product-promo-banner__content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: calc(var(--gap, 8px) * 3);
      padding: calc(var(--gap, 8px) * 3);
      border-radius: 12px;
      background: linear-gradient(
        90deg,
        {{ promo.background_color_start | default: '#c89563' }},
        {{ promo.background_color_end | default: '#5a4b7c' }}
      );
      position: relative;
      overflow: hidden;
    }

    .product-promo-banner__text-container {
      flex: 1;
      z-index: 1;
    }

    .product-promo-banner__title {
      font-family: var(--font-headline, inherit);
      font-size: calc(var(--font-h3-size, 24px) * 1);
      font-weight: var(--font-headline-weight, 600);
      line-height: 1.2;
      color: #ffffff;
      margin: 0;
    }

    .product-promo-banner__image-container {
      position: relative;
      flex-shrink: 0;
      max-width: 200px;
      z-index: 1;
    }

    .product-promo-banner__badge {
      position: absolute;
      top: -10px;
      right: -10px;
      background: #6CB849;
      color: #ffffff;
      font-family: var(--font-body, inherit);
      font-size: 14px;
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 50%;
      min-width: 40px;
      min-height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2;
    }

    .product-promo-banner__image {
      width: 100%;
      height: auto;
      display: block;
    }

    @media (max-width: 749px) {
      .product-promo-banner__content {
        flex-direction: column;
        text-align: center;
        padding: calc(var(--gap, 8px) * 2);
      }

      .product-promo-banner__title {
        font-size: calc(var(--font-h3-size, 24px) * 0.8);
      }

      .product-promo-banner__image-container {
        max-width: 150px;
      }
    }
  </style>
{% endif %}
